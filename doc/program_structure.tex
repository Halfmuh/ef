\section{Структура программы}

Epicf-v0.01 написан на C. 

Основная структура в программе - 'domain'.
Идея в том, что она должна хранить в себе всю информацию, необходимую для 
моделирования. Эту информацию можно разделить на 3 части: информация о 
временной сетке, о пространственной области и ее дискретизации, и информация о частицах.

Генерация частиц:
Максвелловское распределение по компонентам импульса - произведение
нескольких нормальных распределений. 
\todo{(в программе вроде пока один генератор на обе компоненты. эквивалентно?) }

Интерполяция зарядов на узлы сетки. Форма частиц. Картинка. 

Уравнение Пуассона:
\begin{gather}
  \Delta \phi = - 4 \pi \rho  
\end{gather}
\todo{Дописать про дискретизацию и граничные условия.}
Для численного решения используется библиотека FISHPACK [ссылка]. 
При вызове фортрановской функции из C нужно учитывать особенности 
представления многомерных массивов в памяти [ссылка]. \todo{написать по-понятнее}.
В фортране - column-major order, в C - row-major. 
В программе за преобразование между двумя форматами отвечают функции \todo{...}.

Расчет полей по потенциалу:
\begin{gather}
  \vec{ E } = - \nabla \phi
  \\
  \todo{ E_{x_i} =  - \mbox{ центральная разность } }
  \\
  \todo{ E_{x_i} =  - \mbox{ на границе } }
\end{gather}

Обновление импульсов и координат частиц:
\begin{gather}
  \frac{ d \vec{p} }{ d t } = \vec{ F } = q \vec{ E }
  \\
  \frac{ d \vec{r} }{ d t } = \frac{ \vec{p} }{ m }
\end{gather}
Используется схема Leap-frog
\begin{gather}
  \vec{p}_{t+1/2} = \vec{p}_{t-1/2} + q \vec{E} \Delta t  
  \\
  \vec{r}_{t} = \vec{r}_{t-1} + \frac{ \vec{p}_{t+1/2} }{ m } \Delta t
\end{gather}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "major"
%%% End: 
